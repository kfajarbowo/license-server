name: license-server
version: 1.0.0

services:
  - name: license-api
    type: web
    instance_type: nano
    regions:
      - sin  # Singapore - pilih region terdekat
    ports:
      - port: 8000
        protocol: http
    env:
      - name: PORT
        value: "8000"
      - name: HOST
        value: "0.0.0.0"
      - name: NODE_ENV
        value: "production"
      - name: OFFLINE_TOLERANCE_HOURS
        value: "24"
      # ADMIN_PASSWORD harus di-set via Koyeb Dashboard untuk keamanan
    routes:
      - path: /
        port: 8000
    health_checks:
      - http:
          port: 8000
          path: /health
    git:
      branch: main
      buildpack:
        build_command: npm install
        run_command: npm start
